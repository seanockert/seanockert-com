/*
 * jqModal - Minimalist Modaling with jQuery
 *
 * Copyright (c) 2007-2015 Brice Burgess @IceburgBrice
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 * 
 * $Version: 1.3.0 (2015.04.15 +r24)
 * Requires: jQuery 1.2.3+
 */
!function(a){a.fn.jqm=function(b){return this.each(function(){var c=a(this),d=c.data("jqm")||a.extend({ID:l++},a.jqm.params),e=a.extend(d,b);c.data("jqm",e).addClass("jqm-init")[0]._jqmID=e.ID,e.trigger&&c.jqmAddTrigger(e.trigger)})},a.fn.jqmAddTrigger=function(c){return this.each(function(){g(a(this),"jqmShow",c)||b("jqmAddTrigger must be called on initialized modals")})},a.fn.jqmAddClose=function(c){return this.each(function(){g(a(this),"jqmHide",c)||b("jqmAddClose must be called on initialized modals")})},a.fn.jqmShow=function(b){return this.each(function(){!this._jqmShown&&c(a(this),b)})},a.fn.jqmHide=function(b){return this.each(function(){this._jqmShown&&d(a(this),b)})};var b=function(a){window.console&&window.console.error&&window.console.error(a)},c=function(b,c){var d=b.data("jqm"),c=c||window.event,e=parseInt(b.css("z-index")),e=e>0?e:3e3,f=a("<div></div>").addClass(d.overlayClass).css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":e-1,opacity:d.overlay/100}),g={w:b,c:d,o:f,t:c};if(b.css("z-index",e),d.ajax){var i=d.target||b,j=d.ajax;i="string"==typeof i?a(i,b):a(i),"@"==j.substr(0,1)&&(j=a(c).attr(j.substring(1))),i.load(j,function(){d.onLoad&&d.onLoad.call(this,g)}),d.ajaxText&&i.html(d.ajaxText),h(g)}else h(g)},d=function(a,b){var c=a.data("jqm"),b=b||window.event,d={w:a,c:c,o:a.data("jqmv"),t:b};i(d)},e=function(b){return b.c.overlay>0&&b.o.prependTo("body"),b.w.show(),a.jqm.focusFunc(b.w,!0),!0},f=function(a){return a.w.hide()&&a.o&&a.o.remove(),!0},g=function(b,c,d){var e=b.data("jqm");return b.data("jqm")?a(d).each(function(){this[c]=this[c]||[],a.inArray(e.ID,this[c])<0&&(this[c].push(e.ID),a(this).click(function(){return b[c](this),!1}))}):!1},h=function(b){var c=b.w,d=b.o,e=b.c;e.onShow(b)!==!1&&(c[0]._jqmShown=!0,e.modal?(!m[0]&&j("bind"),m.push(c[0])):c.jqmAddClose(d),e.closeClass&&c.jqmAddClose(a("."+e.closeClass,c)),e.toTop&&d&&c.before('<span id="jqmP'+e.ID+'"></span>').insertAfter(d),c.data("jqmv",d),c.unbind("keydown",a.jqm.closeOnEscFunc),e.closeOnEsc&&c.attr("tabindex",0).bind("keydown",a.jqm.closeOnEscFunc).focus())},i=function(b){var c=b.w,d=b.o,e=b.c;e.onHide(b)!==!1&&(c[0]._jqmShown=!1,e.modal&&(m.pop(),!m[0]&&j("unbind")),e.toTop&&d&&a("#jqmP"+e.ID).after(c).remove())},j=function(b){a(document)[b]("keypress keydown mousedown",k)},k=function(b){var c=a(b.target).data("jqm")||a(b.target).parents(".jqm-init:first").data("jqm"),d=m[m.length-1];return c&&c.ID==d._jqmID?!0:a.jqm.focusFunc(d,b)},l=0,m=[];a.jqm={params:{overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",closeOnEsc:!1,trigger:".jqModal",ajax:!1,target:!1,ajaxText:"",modal:!1,toTop:!1,onShow:e,onHide:f,onLoad:!1},focusFunc:function(b,c){return c&&a(":input:visible:first",b).focus(),!1},closeOnEscFunc:function(b){return 27==b.keyCode?(a(this).jqmHide(),!1):void 0}}}(jQuery);